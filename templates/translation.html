<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì‹¤ì‹œê°„ ë²ˆì—­ - ì„¸ì…˜ ë·° (ë³„ë„ íŒì—… ì°½)</title>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<style>
    /* â­ï¸ CSS ë³€ìˆ˜ ì„ ì–¸: í°íŠ¸ í¬ê¸° (JSì—ì„œ ë™ì ìœ¼ë¡œ ë³€ê²½) */
    :root {
        --log-font-size: 14px;
    }

    body {
        font-family: 'Segoe UI', Arial, sans-serif;
        margin:0;
        padding:15px;
        display:flex;
        flex-direction:column;
        height:100vh;
        /* ê¸°ë³¸: ë‹¤í¬ ëª¨ë“œ */
        background: var(--bg-color, #222);
        color: var(--text-color, #fff);
        transition: background 0.3s, color 0.3s;
    }

    /* ë²„íŠ¼ ì»¨í…Œì´ë„ˆ: ë²„íŠ¼ë“¤ì„ ì˜¤ë¥¸ìª½ ìƒë‹¨ì— ë°°ì¹˜ */
    #button-container {
        display: flex;
        gap: 10px;
        align-self: flex-end;
        margin-bottom: 15px;
        z-index: 10;
    }

    #toggle-summary, #toggle-theme, #settings-btn { /* settings-btn ì¶”ê°€ */
        padding:8px 18px;
        cursor:pointer;
        background: var(--button-bg, #1dd1a1);
        border:none;
        border-radius:20px;
        font-weight:bold;
        box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        transition: background 0.3s, color 0.3s;
        color: var(--text-color);
    }
    #settings-btn {
        padding: 8px 12px; /* í†±ë‹ˆë°”í€´ ë²„íŠ¼ì€ íŒ¨ë”© ì¡°ì • */
        font-size: 1.2em;
    }
    #toggle-summary:hover, #toggle-theme:hover, #settings-btn:hover { background: var(--button-hover-bg, #10ac84); }

    /* ë¼ì´íŠ¸ ëª¨ë“œ ë³€ìˆ˜ ì •ì˜ */
    body.light-mode {
        --bg-color: #f4f4f9;
        --text-color: #333;
        --log-bg: rgba(0,0,0,0.05);
        --original-bg: rgba(0,0,0,0.1);
        --original-text: #333;
        --translated-bg: #007bff;
        --translated-text: #fff;
        --timestamp-color: #007bff;
        --button-bg: #007bff;
        --button-hover-bg: #0056b3;
    }

    /* ë‹¤í¬ ëª¨ë“œ ë³€ìˆ˜ ì •ì˜ (ê¸°ì¡´ ê°’) */
    body {
        --bg-color: #222;
        --text-color: #fff;
        --log-bg: rgba(255,255,255,0.05);
        --original-bg: rgba(255,255,255,0.2);
        --original-text: #fff;
        --translated-bg: rgba(255,255,255,0.8);
        --translated-text: #333;
        --timestamp-color: #ffd700;
        --button-bg: #1dd1a1;
        --button-hover-bg: #10ac84;
    }

    /* ì„¤ì • ë©”ë‰´ (ëª¨ë‹¬) ìŠ¤íƒ€ì¼ */
    #settings-modal {
        display: none; /* ì´ˆê¸°ì—ëŠ” ìˆ¨ê¹€ */
        position: absolute;
        top: 60px; /* ë²„íŠ¼ ì•„ë˜ì— ìœ„ì¹˜ */
        right: 15px;
        width: 250px;
        padding: 15px;
        background: var(--bg-color); /* ë°°ê²½ìƒ‰ */
        border: 1px solid var(--log-bg);
        border-radius: 10px;
        box-shadow: 0 8px 16px rgba(0,0,0,0.4);
        z-index: 20;
    }
    .setting-item {
        display: flex;
        flex-direction: column;
        margin-bottom: 15px;
    }
    .setting-item label {
        font-weight: bold;
        margin-bottom: 5px;
    }
    .zoom-controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 10px;
    }
    .zoom-controls button {
        padding: 8px 12px;
        background: var(--button-bg);
        border: none;
        border-radius: 5px;
        cursor: pointer;
        color: var(--text-color);
        font-weight: bold;
    }
    .zoom-controls button:hover {
        background: var(--button-hover-bg);
    }
    #zoom-level, #font-size-level {
        font-size: 1.1em;
        font-weight: bold;
        padding: 5px;
        text-align: center;
        flex-grow: 1;
    }

    /* ì½˜í…ì¸  ì˜ì—­ */
    #content-container {
        flex: 1;
        display: flex;
        min-height: 0;
    }

    #log {
        flex: 1;
        overflow-y:auto;
        display:flex;
        flex-direction:column;
        gap:12px;
        padding:12px;
        border-radius:15px;
        background: var(--log-bg);
        transition: background 0.3s;
    }

    /* ë¡œê·¸ í•­ëª© ìŠ¤íƒ€ì¼ (ìˆ˜ì •: font-sizeì— CSS ë³€ìˆ˜ ì ìš©) */
    .log-entry {
        display:flex;
        flex-direction:column;
        gap:6px;
        opacity:0;
        transform: translateY(10px);
        transition: opacity 0.3s ease, transform 0.3s ease;
    }
    .log-entry.show {
        opacity:1;
        transform: translateY(0);
    }
    .original, .translated {
        max-width:70%;
        padding:10px 14px;
        border-radius:22px;
        word-wrap:break-word;
        /* â­ï¸ í°íŠ¸ í¬ê¸°ë¥¼ CSS ë³€ìˆ˜ì—ì„œ ê°€ì ¸ì˜´ */
        font-size: var(--log-font-size);
        transition: background 0.3s, color 0.3s, font-size 0.3s;
    }
    .original {
        background: var(--original-bg);
        color: var(--original-text);
        align-self:flex-start;
    }
    .translated {
        background: var(--translated-bg);
        color: var(--translated-text);
        align-self:flex-end;
    }
    .timestamp {
        font-size:0.75em;
        color: var(--timestamp-color);
        text-align:center;
        transition: color 0.3s;
    }

    /* íŒì—… ê´€ë ¨ ìš”ì†ŒëŠ” ì œê±°í•˜ê±°ë‚˜ ìˆ¨ê¹€ ì²˜ë¦¬ */
    #summary-log, #summary-content, #summary-close {
        display: none;
    }

</style>
</head>
<body>
    <div id="button-container">
        <button id="settings-btn" title="ì„¤ì •">âš™ï¸</button> <button id="toggle-theme">ğŸŒ ë¼ì´íŠ¸ ëª¨ë“œ</button>
        <button id="toggle-summary">ìš”ì•½ ìƒˆ ì°½ ì—´ê¸°</button>
    </div>

    <div id="settings-modal">
        <div class="setting-item">
            <label>í™”ë©´ í™•ëŒ€/ì¶•ì†Œ</label>
            <div class="zoom-controls">
                <button id="zoom-out-btn">-</button>
                <span id="zoom-level">100%</span>
                <button id="zoom-in-btn">+</button>
            </div>
        </div>

        <div class="setting-item">
            <label>ë²ˆì—­ ë¡œê·¸ í°íŠ¸ í¬ê¸°</label>
            <div class="zoom-controls">
                <button id="font-decrease-btn">A-</button>
                <span id="font-size-level">ê¸°ë³¸</span>
                <button id="font-increase-btn">A+</button>
            </div>
        </div>
    </div>

    <div id="content-container">
        <div id="log"></div>

        </div>

    <script>
    const socket = io();
    const body = document.body;
    const logDiv = document.getElementById("log");
    const toggleBtn = document.getElementById("toggle-summary");
    const themeBtn = document.getElementById("toggle-theme");
    const logs = [];

    // â­ï¸ [ì‹ ê·œ] ì„¤ì • ê´€ë ¨ ë³€ìˆ˜ ì¶”ê°€
    const settingsBtn = document.getElementById("settings-btn");
    const zoomInBtn = document.getElementById("zoom-in-btn");
    const zoomOutBtn = document.getElementById("zoom-out-btn");
    const zoomLevelSpan = document.getElementById("zoom-level");
    const settingsModal = document.getElementById("settings-modal");
    const fontDecreaseBtn = document.getElementById("font-decrease-btn");
    const fontIncreaseBtn = document.getElementById("font-increase-btn");
    const fontSizeLevelSpan = document.getElementById("font-size-level");
    // ------------------------------------------------------------------


    let summaryWindow = null;
    let currentTheme = localStorage.getItem('theme') || 'dark';

    // â­ï¸ [ì‹ ê·œ] ì¤Œ/í°íŠ¸ í¬ê¸° ê´€ë ¨ ë³€ìˆ˜ ì´ˆê¸°í™”
    let currentZoom = 1.0;
    const zoomStep = 0.1;
    let currentFontSize = 14;
    const fontSizeStep = 2;

    // â­ï¸ [ì‹ ê·œ] íŒì—… ì°½ì—ì„œ í˜¸ì¶œí•  í•¨ìˆ˜ (2ê°œ)
    window.requestSpecificSummaryFromPopup = (sessionId) => {
        if (sessionId) {
            console.log(`[Main] íŒì—…ìœ¼ë¡œë¶€í„° ì„¸ì…˜ ìš”ì²­ ë°›ìŒ: ${sessionId}`);
            socket.emit("request_specific_summary", {
                session_id: sessionId
            });

            if (summaryWindow && !summaryWindow.closed) {
                const summaryTextDiv = summaryWindow.document.getElementById('summary-text');
                if (summaryTextDiv) {
                    summaryTextDiv.textContent = '[ì„ íƒí•œ ì„¸ì…˜ ìš”ì•½ ë¡œë“œ ì¤‘...]';
                }
            }
        }
    }

    window.requestRenameSessionFromPopup = (oldId, newId) => {
        if (oldId && newId) {
            console.log(`[Main] íŒì—…ìœ¼ë¡œë¶€í„° ì´ë¦„ ë³€ê²½ ìš”ì²­ ë°›ìŒ: ${oldId} -> ${newId}`);
            socket.emit("request_rename_session", {
                old_id: oldId,
                new_id: newId
            });

            if (summaryWindow && !summaryWindow.closed) {
                const summaryTextDiv = summaryWindow.document.getElementById('summary-text');
                if (summaryTextDiv) {
                    summaryTextDiv.textContent = `[ì´ë¦„ ë³€ê²½ ì¤‘: ${oldId} -> ${newId}...]`;
                }
            }
        }
    }

    // â­ï¸ [ì‹ ê·œ] ì¤Œ/í°íŠ¸ í¬ê¸° ê´€ë ¨ ë¡œì§ í•¨ìˆ˜
    function updateZoom(newZoom) {
        currentZoom = Math.max(0.5, Math.min(2.0, newZoom)); // 50% ~ 200% ì œí•œ
        document.body.style.zoom = currentZoom;
        zoomLevelSpan.textContent = `${Math.round(currentZoom * 100)}%`;
    }

    function updateFontSize(newSize) {
        currentFontSize = Math.max(10, Math.min(24, newSize)); // í°íŠ¸ í¬ê¸° ì œí•œ
        document.documentElement.style.setProperty('--log-font-size', `${currentFontSize}px`);

        let levelText = "ê¸°ë³¸";
        if (currentFontSize > 14) {
             levelText = `+${(currentFontSize - 14) / fontSizeStep}`;
        } else if (currentFontSize < 14) {
             levelText = `-${(14 - currentFontSize) / fontSizeStep}`;
        }
        fontSizeLevelSpan.textContent = levelText;

        const entries = logDiv.querySelectorAll('.original, .translated');
        entries.forEach(el => el.style.fontSize = `${currentFontSize}px`);
    }

    // â­ï¸ [ì‹ ê·œ] ì¤Œ/í°íŠ¸ ì´ˆê¸° ì„¤ì • ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    updateZoom(currentZoom);
    updateFontSize(currentFontSize);

    zoomInBtn.addEventListener('click', () => {
        updateZoom(currentZoom + zoomStep);
    });

    zoomOutBtn.addEventListener('click', () => {
        updateZoom(currentZoom - zoomStep);
    });

    fontIncreaseBtn.addEventListener('click', () => {
        updateFontSize(currentFontSize + fontSizeStep);
    });

    fontDecreaseBtn.addEventListener('click', () => {
        updateFontSize(currentFontSize - fontSizeStep);
    });


    function applyTheme(theme) {
        if (theme === 'light') {
            body.classList.add('light-mode');
            themeBtn.innerHTML = "ğŸŒ™ ë‹¤í¬ ëª¨ë“œ";
        } else {
            body.classList.remove('light-mode');
            themeBtn.innerHTML = "ğŸŒ ë¼ì´íŠ¸ ëª¨ë“œ";
        }
        localStorage.setItem('theme', theme);
        currentTheme = theme;

        // íŒì—… ì°½ í…Œë§ˆ ë™ê¸°í™” (ì°½ì´ ì—´ë ¤ìˆë‹¤ë©´)
        if (summaryWindow && !summaryWindow.closed) {
            const doc = summaryWindow.document;
            const popupBg = theme === 'light' ? '#f4f4f9' : '#222';
            const popupText = theme === 'light' ? '#333' : '#fff';
            const popupHighlight = theme === 'light' ? '#007bff' : '#1dd1a1';
            const popupBorder = theme === 'light' ? '#ddd' : '#555';
            const popupInputBg = theme === 'light' ? '#fff' : '#444';
            const popupSummaryBg = theme === 'light' ? '#f9f9f9' : '#2a2a2a';

            doc.body.style.background = popupBg;
            doc.body.style.color = popupText;

            const h1 = doc.querySelector('h1');
            if(h1) h1.style.color = popupHighlight;

            const sessionSelect = doc.getElementById('session-select');
            if (sessionSelect) {
                sessionSelect.style.borderColor = popupBorder;
                sessionSelect.style.background = popupInputBg;
                sessionSelect.style.color = popupText;
            }
            const summaryTextDiv = doc.getElementById('summary-text');
            if (summaryTextDiv) {
                summaryTextDiv.style.borderColor = popupBorder;
                summaryTextDiv.style.background = popupSummaryBg;
            }
            const renameBtn = doc.getElementById('rename-btn');
            if (renameBtn) {
                renameBtn.style.background = popupHighlight;
                renameBtn.style.color = popupText;
            }
        }
    }

    applyTheme(currentTheme);

    themeBtn.addEventListener('click', () => {
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        applyTheme(newTheme);
    });

    // â­ï¸ [ì‹ ê·œ] ì„¤ì • ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (ëª¨ë‹¬ í† ê¸€)
    settingsBtn.addEventListener('click', (event) => {
        event.stopPropagation();
        settingsModal.style.display = settingsModal.style.display === 'block' ? 'none' : 'block';
    });

    // â­ï¸ [ì‹ ê·œ] ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ëª¨ë‹¬ ë‹«ê¸°
    document.addEventListener('click', (event) => {
        if (settingsModal.style.display === 'block' &&
            !settingsModal.contains(event.target) &&
            event.target !== settingsBtn) {
            settingsModal.style.display = 'none';
        }
    });

    // íŒì—… ì°½ ì—´ê¸° ë° ë‚´ìš© ì—…ë°ì´íŠ¸ ë¡œì§
    function openSummaryWindow() {
        if (summaryWindow && !summaryWindow.closed) {
            summaryWindow.focus();
            socket.emit("request_summary", {});
            return;
        }

        const windowFeatures = 'width=500,height=600,scrollbars=yes,resizable=yes,top=100,left=100';
        summaryWindow = window.open('', 'SummaryPopup', windowFeatures);

        if (summaryWindow) {
             const popupBg = currentTheme === 'light' ? '#f4f4f9' : '#222';
            const popupText = currentTheme === 'light' ? '#333' : '#fff';
            const popupHighlight = currentTheme === 'light' ? '#007bff' : '#1dd1a1';
            const popupBorder = currentTheme === 'light' ? '#ddd' : '#555';
            const popupInputBg = currentTheme === 'light' ? '#fff' : '#444';
            const popupSummaryBg = currentTheme === 'light' ? '#f9f9f9' : '#2a2a2a';
            const renameBtnBg = popupHighlight;
            const renameBtnColor = popupText;
            const renameBtnHoverBg = currentTheme === 'light' ? '#0056b3' : '#10ac84';

            // â­ï¸ [ìˆ˜ì •] íŒì—… HTMLì— ë²„íŠ¼ ì¶”ê°€ ë° ìŠ¤íƒ€ì¼ë§
            const popupHTML = `
                <!DOCTYPE html>
                <html lang="ko">
                <head>
                    <meta charset="UTF-8">
                    <title>íšŒì˜ ìš”ì•½</title>
                    <style>
                        body {
                            font-family: 'Segoe UI', Arial, sans-serif;
                            margin: 0;
                            padding: 20px;
                            background: ${popupBg};
                            color: ${popupText};
                            line-height: 1.6;
                            transition: background 0.3s, color 0.3s;
                        }
                        h1 {
                            text-align: center;
                            color: ${popupHighlight};
                            margin-bottom: 20px;
                            font-size: 1.5em;
                        }

                        #session-controls {
                            display: flex;
                            gap: 10px;
                            margin-bottom: 15px;
                            align-items: stretch;
                        }
                        #session-controls label {
                            font-weight: bold;
                            padding: 8px 0;
                        }
                        #session-select {
                            flex: 1;
                            padding: 8px;
                            border-radius: 5px;
                            border: 1px solid ${popupBorder};
                            background: ${popupInputBg};
                            color: ${popupText};
                            font-size: 0.9em;
                        }

                        /* â­ï¸ ì´ë¦„ ë³€ê²½ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
                        #rename-btn {
                            padding: 8px 12px;
                            border-radius: 5px;
                            border: none;
                            background: ${renameBtnBg};
                            color: ${renameBtnColor};
                            cursor: pointer;
                            font-weight: bold;
                            font-size: 0.9em;
                            transition: background 0.3s;
                        }
                        #rename-btn:hover {
                            background: ${renameBtnHoverBg};
                        }

                        #summary-text {
                            white-space: pre-wrap;
                            border: 1px solid ${popupBorder};
                            padding: 15px;
                            border-radius: 8px;
                            background: ${popupSummaryBg};
                            min-height: 300px;
                        }
                    </style>
                </head>
                <body>
                    <h1>íšŒì˜ ìš”ì•½</h1>

                    <div id="session-controls">
                        <label for="session-select">ì„¸ì…˜:</label>
                        <select id="session-select">
                            <option value="">[ë¡œë“œ ì¤‘...]</option>
                        </select>
                        <button id="rename-btn">ì´ë¦„ ë³€ê²½</button>
                    </div>

                    <div id="summary-text">[ìš”ì•½ ìƒì„± ì¤‘...]</div>

                    <script>
                        const sessionSelect = document.getElementById('session-select');
                        const renameBtn = document.getElementById('rename-btn');

                        // 1. ë“œë¡­ë‹¤ìš´ ë³€ê²½ ë¦¬ìŠ¤ë„ˆ
                        sessionSelect.addEventListener('change', () => {
                            const selectedSessionId = sessionSelect.value;
                            if (selectedSessionId && window.opener && typeof window.opener.requestSpecificSummaryFromPopup === 'function') {
                                window.opener.requestSpecificSummaryFromPopup(selectedSessionId);
                            } else {
                                console.error("Opener ë˜ëŠ” ìš”ì•½ ìš”ì²­ í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                                document.getElementById('summary-text').textContent = '[ì˜¤ë¥˜: ë©”ì¸ ì°½ê³¼ ì—°ê²° ì‹¤íŒ¨]';
                            }
                        });

                        // 2. â­ï¸ ì´ë¦„ ë³€ê²½ ë²„íŠ¼ ë¦¬ìŠ¤ë„ˆ
                        renameBtn.addEventListener('click', () => {
                            const oldId = sessionSelect.value;
                            if (!oldId || oldId.startsWith('[')) { // ë¡œë“œ ì¤‘ì´ê±°ë‚˜ ì„ íƒë˜ì§€ ì•Šì€ ê²½ìš° ì œì™¸
                                alert("ì´ë¦„ì„ ë³€ê²½í•  ì„¸ì…˜ì´ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
                                return;
                            }

                            const newId = prompt("ìƒˆë¡œìš´ ì„¸ì…˜ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:", oldId);

                            if (newId === null || newId.trim() === "" || newId.trim() === oldId) {
                                return;
                            }

                            if (window.opener && typeof window.opener.requestRenameSessionFromPopup === 'function') {
                                window.opener.requestRenameSessionFromPopup(oldId, newId.trim());
                            } else {
                                console.error("Opener ë˜ëŠ” ì´ë¦„ ë³€ê²½ ìš”ì²­ í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                                document.getElementById('summary-text').textContent = '[ì˜¤ë¥˜: ë©”ì¸ ì°½ê³¼ ì—°ê²° ì‹¤íŒ¨]';
                            }
                        });
                    <\/script>
                </body>
                </html>
            `;

            summaryWindow.document.write(popupHTML);
            summaryWindow.document.close();
            socket.emit("request_summary", {});

        } else {
            alert("íŒì—… ì°½ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");
        }
    }


    toggleBtn.addEventListener("click", () => {
        openSummaryWindow();
    });

    // ----------------------------------------------------
    // âœ¨ Socket.IO ì—°ë™ ë¡œì§
    // ----------------------------------------------------

    socket.on("connect", () => console.log("âœ… ì„œë²„ ì—°ê²° ì„±ê³µ"));

    // 1. ì‹¤ì‹œê°„ ë²ˆì—­ ë¡œê·¸ ìˆ˜ì‹ 
    socket.on("partial_translation", data => {
        logs.push(data);
        renderLogs(logDiv, logs, true);
    });

    // 2. ì„œë²„ì—ì„œ ìš”ì•½ ë°ì´í„° ìˆ˜ì‹ 
    socket.on("summary_data_updated", data => {
        console.log("âœ… ì„œë²„ë¡œë¶€í„° ìš”ì•½ ë°ì´í„°ë¥¼ ìˆ˜ì‹ í–ˆìŠµë‹ˆë‹¤.", data);

        if (!summaryWindow || summaryWindow.closed) {
            return;
        }

        // 1. ìš”ì•½ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        const summaryTextDiv = summaryWindow.document.getElementById('summary-text');
        if (summaryTextDiv) {
            summaryTextDiv.textContent = data.summary;
        }

        // 2. ì„¸ì…˜ ëª©ë¡(ë“œë¡­ë‹¤ìš´) ì±„ìš°ê¸°
        if (data.all_sessions && data.all_sessions.length > 0) {
            const sessionSelect = summaryWindow.document.getElementById('session-select');
            if (sessionSelect) {
                sessionSelect.innerHTML = "";

                data.all_sessions.forEach(sessionId => {
                    const option = summaryWindow.document.createElement('option');
                    option.value = sessionId;
                    option.textContent = sessionId;
                    sessionSelect.appendChild(option);
                });
            }
        }

        // 3. í˜„ì¬ ì„¸ì…˜ IDë¡œ ë“œë¡­ë‹¤ìš´ ì„ íƒ ì„¤ì •
        if (data.current_session_id) {
            const sessionSelect = summaryWindow.document.getElementById('session-select');
            if (sessionSelect) {
                sessionSelect.value = data.current_session_id;
            }
        }
    });


    function renderLogs(container, dataLogs, scrollToBottom=false){
        container.innerHTML = "";
        dataLogs.forEach(data => {
            const entry = document.createElement("div");
            entry.classList.add("log-entry");

            const timeDiv = document.createElement("div");
            timeDiv.classList.add("timestamp");
            timeDiv.textContent = data.time || "";

            const originalDiv = document.createElement("div");
            originalDiv.classList.add("original");
            originalDiv.textContent = data.original;
            originalDiv.style.fontSize = `${currentFontSize}px`; // â­ï¸ ë™ì  í°íŠ¸ í¬ê¸° ì ìš©

            const translatedDiv = document.createElement("div");
            translatedDiv.classList.add("translated");
            translatedDiv.textContent = data.translated;
            translatedDiv.style.fontSize = `${currentFontSize}px`; // â­ï¸ ë™ì  í°íŠ¸ í¬ê¸° ì ìš©

            entry.appendChild(timeDiv);
            entry.appendChild(originalDiv);
            entry.appendChild(translatedDiv);

            container.appendChild(entry);
            setTimeout(() => entry.classList.add("show"), 10);
        });
        if(scrollToBottom) container.scrollTop = container.scrollHeight;
    }
</script>
</body>
</html>